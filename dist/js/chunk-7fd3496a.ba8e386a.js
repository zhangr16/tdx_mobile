(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fd3496a"],{"126b":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"applyAfter"},[i("header",[i("van-icon",{staticClass:"left_arrow",attrs:{name:"arrow-left"},on:{click:function(t){return e.$router.go(-1)}}}),e._v("\n    "+e._s(e.form.sale_type||"申请售后")+"\n  ")],1),i("main",[e.isloading?i("van-skeleton",{attrs:{title:"",avatar:"",row:5}}):i("div",{staticClass:"wrapper"},[i("div",{staticClass:"applyAfter_body"},[i("img",{attrs:{src:e.entity.img,alt:""}}),3!=e.entity.order_type?i("ul",[i("li",[e._v(e._s(e.entity.title))]),i("li",{staticClass:"scale_num"},[e._v("订单编号："+e._s(e.entity.order_sn))]),i("li",[i("span",[e._v("\n              原价：\n              "),i("i",[e._v("¥"+e._s(e.entity.price))])])]),i("li",[i("span",[e._v("\n              实拍：\n              "),i("i",[e._v("¥"+e._s(e.entity.reality_price))])]),i("span",[e._v("\n              可获积分：\n              "),i("i",[e._v(e._s(e.entity.get_integral))])])]),i("li",[e._v("账号："+e._s(e.entity.mobile))])]):i("ul",[i("li",[e._v(e._s(e.entity.title))]),i("li",{staticClass:"scale_num"},[e._v("订单编号："+e._s(e.entity.order_sn))]),i("li",[e._v("账号："+e._s(e.entity.mobile))]),i("li",[i("span",[e._v("\n              优惠价：\n              "),i("i",[e._v("¥"+e._s(e.entity.current_price))])]),i("span",[e._v("\n              返利：\n              "),i("i",[e._v("¥"+e._s(e.entity.price-e.entity.reality_price))])])]),i("li",[i("span",[e._v("\n              原价：\n              "),i("i",[e._v("¥"+e._s(e.entity.price))])]),i("span",[e._v("\n              实拍：\n              "),i("i",[e._v("¥"+e._s(e.entity.reality_price))])]),i("span",[e._v("\n              积分：\n              "),i("i",[e._v(e._s(-e.entity.integral))])])])])]),i("van-cell-group",[i("van-field",{attrs:{clearable:"",readonly:"",clickable:"",label:"申请原因",value:e.form.sale_type,placeholder:"请选择"},on:{click:function(){e.isEdit||(e.showPicker=!0)}}}),"资金问题"==e.form.sale_type?i("van-cell",{staticClass:"uploads",attrs:{title:"实拍金额"}},[i("div",{staticClass:"_funds"},[e._v("\n            ¥\n            "),i("van-stepper",{attrs:{step:"0.01","decimal-length":2,min:"0"},model:{value:e.form.reality_price,callback:function(t){e.$set(e.form,"reality_price",t)},expression:"form.reality_price"}}),i("br"),e._v("任务金额: ¥\n            "),i("van-stepper",{attrs:{disabled:"",value:e.entity.price,step:"0.01","decimal-length":2}}),e._v("差价金额: ¥\n            "),i("van-stepper",{attrs:{disabled:"",value:e.form.reality_price-e.entity.price||0,step:"0.01","decimal-length":2,min:"-99999"}})],1)]):e._e(),i("van-field",{attrs:{type:"textarea",rows:"1",autosize:"",label:"售后说明",placeholder:"请填写售后说明"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}}),i("van-cell",{staticClass:"uploads",attrs:{title:"售后凭证",label:"（最多3张）"}},[i("van-uploader",{attrs:{"after-read":e.afterRead,"before-delete":e.beforeDel,multiple:"","max-count":3},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1),i("div",{staticClass:"submit_btn",on:{click:e.handleSubmit}},[e._v("提 交")])],1)],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{cancel:function(t){e.showPicker=!1},confirm:e.onConfirm}})],1)],1)},r=[],s=(i("96cf"),i("3b8d")),a=i("365c"),l={name:"applyAfter",components:{},data:function(){return{showPicker:!1,isloading:!1,columns:["资金问题","物流问题","礼品问题","其他"],fileList:[],form:{comment:"",sale_type:null,reality_price:null},_id:null,isEdit:!1,entity:{}}},mounted:function(){this.$route.query.id&&(this._id=this.$route.query.id),this.$route.query.e&&(this.isEdit=!0),this.getData()},methods:{getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.isloading=!0,!this.isEdit){e.next=8;break}return e.next=4,Object(a["o"])({action:5,sale_id:this._id});case 4:t=e.sent,t&&200==t.error.errno&&(this.entity=t.saleInfo,this.form={sale_type:this.columns[t.saleInfo.sale_type-1],reality_price:t.saleInfo.reality_price,comment:t.saleInfo.comment},t.saleInfo.apply_img.map(function(e){n.fileList.push({url:e})})),e.next=12;break;case 8:return e.next=10,Object(a["o"])({action:1,id:this._id});case 10:i=e.sent,i&&200==i.error.errno&&(this.entity=i.orderInfo,this.form.reality_price=i.orderInfo.reality_price);case 12:this.isloading=!1;case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),onConfirm:function(e){this.form.sale_type=e,this.showPicker=!1},afterRead:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=new FormData,i.append("img",t.file),e.next=4,Object(a["v"])(i);case 4:n=e.sent,n&&200==n.error.errno&&(this.$toast.success("图片上传成功"),t.url=n.url);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),beforeDel:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["c"])({url:t.url});case 2:if(i=e.sent,!i||200!=i.error.errno){e.next=6;break}return this.$toast.success("图片删除成功"),e.abrupt("return",!0);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleSubmit:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,i,n,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.form.sale_type){e.next=2;break}return e.abrupt("return",this.$toast.fail("请选择申请原因"));case 2:return t=[],this.fileList.map(function(e){t.push(e.url)}),i=this.isEdit?{action:6,sale_id:this._id,sale_type:this.columns.indexOf(this.form.sale_type)+1,comment:this.form.comment,apply_img:t}:{action:2,id:this._id,sale_type:this.columns.indexOf(this.form.sale_type)+1,comment:this.form.comment,apply_img:t},1==i.sale_type&&(i.reality_price=this.form.reality_price),e.next=8,Object(a["o"])(i);case 8:n=e.sent,n&&200==n.error.errno&&(this.$toast.success(n.error.usermsg),setTimeout(function(){r.$router.push("/task")},500));case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},o=l,c=(i("5b15"),i("2877")),u=Object(c["a"])(o,n,r,!1,null,null,null);t["default"]=u.exports},"5b15":function(e,t,i){"use strict";var n=i("ee77"),r=i.n(n);r.a},ee77:function(e,t,i){}}]);